- provide(:title, 'Muokkaa resepti')
%h1 Muokkaa reseptiä
.row
  .span6.offset3.well.green
    = form_for @recipe do |f|
      = render 'shared/recipe_error_messages'
      %p
        = f.label :name, "Nimi"
        = f.text_field :name 
        
        = f.label :price, "Hinta (€)"
        = f.number_field :price, disabled: true, min: 0
        
      %h4 Raaka-aineet:
      
      %ul.materials
        - @recipe.hasmaterials.each do |material|
          %li{:id=> "#{material.material_id}"}
            - mat = Material.find(material.material_id)
            = hidden_field_tag "old_materials[#{material.material_id}, #{material.amount}]", material.amount
            = link_to mat.name, mat
            , #{material.amount} g
            |
            = link_to_function "poista", "remove_list_element(#{material.material_id})" 
              
      %h4 Lisää nämä:
      %ul#recipe_materials
        - @added_materials.each do |material, amount|
          %li= link_to material[0].name, material[0]
          
      %p.well  
        = select("post", "material_id", @bakery.materials.collect {|m| [ m.name, m.id ] }, {:prompt => 'Valitse raaka-aine'})
        = fields_for :material do |h|
          = h.label :amount, "Määrä (g)"
          = h.number_field :amount, min: 0
        
        = button_to_function "Lisää", "add_material(event)", :class => "btn btn-mini"
      
      = f.submit "Tallenna", class: "btn btn-large btn-primary"
      
    %p
      = link_to request.env["HTTP_REFERER"] do
        %i.icon-arrow-left
        Takaisin
      |
      = link_to "Kaikki reseptit", :controller => "recipes", :action => "index", :bakery_id => @bakery.id
      |
      = link_to "Poista", @recipe, method: :delete, confirm: "Haluatko varmasti poistaa reseptin?"
